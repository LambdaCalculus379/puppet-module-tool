This started as a spike; I should really add some tests.
