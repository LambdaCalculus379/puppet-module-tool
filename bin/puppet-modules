#!/usr/bin/env ruby

require 'main'

$LOAD_PATH.unshift(File.dirname(__FILE__) + "/../lib")

Main do

  option 'repository', 'r' do
    cast :uri
    default URI.parse('http://modules.puppetlabs.com')
    argument :required
  end
  
  mode :install do
    argument :name do
      required
    end
    def run
      require 'puppet/applications/module_installer'
      installer = Puppet::Applications::ModuleInstaller.new(params[:repository].value, params[:name].value)
      installer.run
    end
  end

  mode :release do
    argument :filename do
      required
      validate { |value| File.file?(value) }
    end
    def run
      require 'puppet/applications/module_releaser'
      releaser = Puppet::Applications::ModuleReleaser.new(params[:repository].value, params[:filename].value)
      releaser.run
    end
  end

end  
